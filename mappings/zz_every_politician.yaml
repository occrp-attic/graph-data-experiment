database: $DATAVAULT_DATABASE_URI
query: SELECT * FROM zz_every_politician WHERE LENGTH(end_date) < 4;
nodes:
  person:
    label: Actor
    properties:
      name:
        column: name
      fingerprint:
        column: name
        transform: fingerprint
        key: true
      isPEP:
        literal: true
      countryCode:
        column: country_code
      gender:
        column: gender
  legislature:
    label: PublicBody
    properties:
      name:
        column: legislature_name
      fingerprint:
        format: "%(country_code)s:%(legislature_name)s"
        transform: fingerprint
        key: true
      countryCode:
        column: country_code
      isParliament:
        literal: true
  group:
    label: Actor
    properties:
      name:
        column: parties
      fingerprint:
        column: parties
        transform: fingerprint
        key: true
      countryCode:
        column: country_code
  email:
    label: Email
    properties:
      name:
        column: email
      fingerprint:
        column: email
        transform: email
        key: true
edges:
  - label: MEMBER_OF
    source: person
    target: legislature
    properties:
      period:
        column: period_name
      term:
        column: term
      chamber:
        column: chamber
  - label: MEMBER_OF
    source: person
    target: group
  - label: CONTACT_VIA
    source: person
    target: email
